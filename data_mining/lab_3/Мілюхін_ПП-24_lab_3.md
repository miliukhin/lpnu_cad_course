---
pdf-engine: xelatex
header-includes:
- \input{$UNI/.templates/settings/preamble.tex}
- \input{$UNI/.templates/settings/minted_settings.tex}
- \newcommand\Type{\Lab}
- \Work{datamining}
- \renewcommand\Variant{5}
- \newcommand\Date{13.3.\the\year}
- \newcommand\Number{3}
- \newcommand\Topic{Робота зі зведеними таблицями та діаграмами в MS Excel.}
---

\input{$UNI/.templates/parts/header.tex}
Навчитися створювати Зведені таблиці, консолідувати дані, групувати та
фільтрувати їх, формувати та форматувати проміжні та підсумкові звіти.

# Індивідуальне завдання

У вас є зразок зведеної таблиці та статистичні збірники з даними, на основі яких
ви можете створити зведені таблиці.

1. Детально вивчіть зразок зведеної таблиці. Зверніть увагу на те, які дані
   приведені, як вони організовані та які висновки можна зробити на підставі
   цієї таблиці.
2. Виберіть один зі статистичних збірників, який вам найбільш цікавий.
   Перегляньте доступні дані та визначте, які з них було б корисно представити
   за допомогою зведеної таблиці.
3. Створіть свою власну зведену таблицю на основі ваших даних. Пам'ятайте про
   те, що таблиця повинна бути логічною, корисною та зрозумілою. Ви також
   можете додатково групувати дані чи використовувати діаграми, якщо це
   потрібно.
4. Проаналізуйте отриману зведену таблицю - що ви можете сказати про дані на
   основі вашої таблиці? Які висновки можна дістати?
5. Виконайте із своєю таблицею завдання, які наведені для таблиці – прикладу.

## Приклад

1. Перейменуйте Лист1 на Продаж та запаси та створіть таблицю Продаж та запаси
   в організаціях оптово-роздрібної торгівлі окремих видів продукції (товарів).
2. Зробіть копію аркуша Аркуш1 і перейменуйте його на Підсумки1.
3. Відсортуйте таблицю на аркуші Підсумки1 за стовпцем Категорія товару за
   абеткою.
4. Додайте проміжні підсумки за кількістю одиниць проданих та запасених товарів
   у 2011 році.
5. За допомогою кнопок структурних рівнів залиште таблиці лише підсумкові
   рядки.
6. Зробіть копію аркуша Аркуш1 і перейменуйте його на Підсумки2.
7. Відсортуйте таблицю на аркуші Підсумки2 за стовпцем Продаж (запаси) за
   абеткою, а у разі однакових значень у стовпці продаж (запаси) – за стовпцем
   Категорія товару за абеткою.
8. Додайте проміжні підсумки за кількістю одиниць проданих та запасених товарів
   у кожній категорії у 2021 році.
9. Зробіть копію аркуша Аркуш1 і перейменуйте його на Зведена таблиця1.
10. Складіть зведену таблицю, яка показує середню кількість товару в кожній
    категорії за 2021 рік.
11. Розмістіть дані стовпців продукти харчування та непродовольчі на різних
    сторінках зведеної таблиці.
12. Зробіть копію аркуша Аркуш1 і перейменуйте його на Зведена таблиця2.
13. Складіть зведену таблицю, яка показує максимальну кількість товару в кожній
    категорії за 2021 рік.
14. Змініть функцію максимуму на функцію пошуку мінімуму кожного стовпця.
15. На окремому аркуші побудуйте зведену діаграму для порівняння кількості
    товару у кожній категорії за 2021 рік.

# Етапи розв'язку
## Підготовка даних
```r
> sales <- read.csv("data.csv")
> sales

              Категорія                     Назва.товару Ціна X2015 X2016 X2017
1             Смартфони             Смартфон SuperGadget  600  1200  1500  1100
2             Смартфони              Смартфон TechWonder  700   900  1100   800
3             Смартфони               Смартфон MegaGizmo  800  1500  1800  1300
4             Смартфони               Смартфон HyperTech  500   800  1000   700
5             Смартфони            Смартфон QuantumQuirk  900  1600  2000  1500
6             Смартфони            Смартфон PixelPizzazz  750  1100  1300  1000
7             Смартфони              Смартфон GigaGadget  650  1000  1200   900
8             Смартфони               Смартфон TurboTech  850  1400  1600  1200
9             Смартфони            Смартфон SparkleSurge  550   700   800   600
10            Смартфони              Смартфон NovaNoodle 1000  1800  2200  1700
11             Ноутбуки             Ноутбук QuantumQuest 1200   900  1000   800
12             Ноутбуки           Ноутбук UltraPixelBook 1500  1100  1200  1000
13             Ноутбуки              Ноутбук SpeedySpecs 1100  1300  1400  1200
14             Ноутбуки            Ноутбук GigaGizmoBook 1800  1600  1800  1500
15             Ноутбуки               Ноутбук WonderWave 2000  2000  2400  1900
16             Ноутбуки             Ноутбук QuantumQuill 1300  1200  1400  1100
17 Комп'ютерне приладдя             Клавіатура HyperType   50  5000  5500  4800
18 Комп'ютерне приладдя                   Миша TechClick   30  4800  5000  4200
19 Комп'ютерне приладдя                 Монітор MegaView  300  1200  1400  1100
20 Комп'ютерне приладдя               Принтер PixelPrint  150   700   800   600
21 Комп'ютерне приладдя     Акустична система SonicSurge  120  1500  1700  1400
22 Комп'ютерне приладдя               USB-хаб QuantumHub   20  2000  2200  1900
23 Комп'ютерне приладдя     Флеш-накопичувач SpeedyStick   15  3000  3200  2800
24 Комп'ютерне приладдя          Жорсткий диск MegaDrive  100   800  1000   700
25 Комп'ютерне приладдя                  Миша TurboTouch   40  2500  2700  2300
26 Комп'ютерне приладдя     Комп'ютерний коврик PixelPad   10  4000  4200  3800
27            Аксесуари            Навушники QuantumBeats  80  1800  2000  1600
28            Аксесуари Бездротова клавіатура WonderKeys   60  1200  1400  1100
29            Аксесуари           Web-камера UltraVision   25  3000  3200  2800
30            Аксесуари          Маршрутизатор SpeedyNet   70  1000  1200   900
```

## Вибірки
### Кількість проданих товарів із кожної категорії за роками
```r
> sales_count <- data.frame(sales %>% group_by(Категорія) %>% summarise(x2015 = sum(X2015),

+ x2016 = sum(X2016), x2017 = sum(X2017)))

> sales_count
             Категорія x2015 x2016 x2017
1            Аксесуари  7000  7800  6400
2 Комп'ютерне приладдя 25500 27700 23600
3             Ноутбуки  8100  9200  7500
4            Смартфони 12000 14500 10800
```

### Середня ціна товарів за категоріями
```r
> average_price <- data.frame(sales %>% group_by(Категорія) %>% summarise(mean = mean(Ціна)))
> average_price
             Категорія     mean
1            Аксесуари   58.750
2 Комп'ютерне приладдя   83.500
3             Ноутбуки 1483.333
4            Смартфони  730.000
```

### Середня кількість проданих одиниць товару за категоріями
```r
> mean_sales_2017 <- data.frame(sales %>% group_by(Категорія) %>% summarise(сер_кількість_проданих

+ = mean(X2017)))

> mean_sales_2017[with(mean_sales_2017, order(сер_кількість_проданих, decreasing=TRUE)),]

             Категорія сер_кількість_проданих
2 Комп'ютерне приладдя                   2360
1            Аксесуари                   1600
3             Ноутбуки                   1250
4            Смартфони                   1080
```

### Найдорожчі товари та їх продажі за роками
```r
> sales %>% group_by(Категорія) %>% filter(Ціна == max(Ціна, na.rm = TRUE))

# A tibble: 4 × 6
# Groups:   Категорія [4]
  Категорія            Назва.товару           Ціна X2015 X2016 X2017
  <chr>                <chr>                 <int> <int> <int> <int>
1 Смартфони            Смартфон NovaNoodle    1000  1800  2200  1700
2 Ноутбуки             Ноутбук WonderWave     2000  2000  2400  1900
3 Комп'ютерне приладдя Монітор MegaView        300  1200  1400  1100
4 Аксесуари            Навушники QuantumBeats    80  1800  2000  1600
```

### Товари, яких у 2017 році продали найбільше:
```r
> data.frame(sales %>% group_by(Категорія) %>% filter(X2017 == max(X2017)))

             Категорія           Назва.товару Ціна X2015 X2016 X2017
1            Смартфони    Смартфон NovaNoodle 1000  1800  2200  1700
2             Ноутбуки     Ноутбук WonderWave 2000  2000  2400  1900
3 Комп'ютерне приладдя   Клавіатура HyperType   50  5000  5500  4800
4            Аксесуари Web-камера UltraVision   25  3000  3200  2800
```

### Товари, яких продали найменше у 2017
```r
> sales %>% group_by(Категорія) %>% summarise(кількість = min(X2017), Назва = first(Назва.товару))

# A tibble: 4 × 3
  Категорія            кількість Назва
  <chr>                    <int> <chr>
1 Аксесуари                  900 Навушники QuantumBeats
2 Комп'ютерне приладдя       600 Клавіатура HyperType
3 Ноутбуки                   800 Ноутбук QuantumQuest
4 Смартфони                  600 Смартфон SuperGadget
```

# Висновок

Я по-різному відфільтрував та згрупував дані в нових таблицях, намагаючись отримати щось корисне. Виходячи з отриманих даних, можна сказати,
що такі товари варто закупити більше:

* NovaNoodle
* Ноутбук WonderWave
* Клавіатура HyperType
* Web-камера UltraVision

А такі, мабуть, не варто:

* Навушники QuantumBeats
* Клавіатура HyperType
* Ноутбук QuantumQuest
* Смартфон SuperGadget
